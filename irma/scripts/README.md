# IRMA/USDT Pool Creation Scripts

This directory contains TypeScript scripts for creating and integrating an IRMA/USDT trading pool on Orca Whirlpools.

## Scripts Overview

### 1. `pool_creation_guide.ts` - Pool Creation Instructions
Provides comprehensive instructions for creating the IRMA/USDT pool using different methods.

**Usage:**
```bash
ts-node scripts/pool_creation_guide.ts
```

**What it does:**
- Shows pool configuration details
- Provides step-by-step instructions for web UI creation
- Shows CLI commands for pool creation
- Displays TypeScript SDK code examples

### 2. `pool_integration_demo.ts` - Pool Integration Demo
Demonstrates how to interact with an existing IRMA/USDT pool and integrate it into your Solana program.

**Usage:**
```bash
ts-node scripts/pool_integration_demo.ts
```

**What it does:**
- Connects to the pool and reads current data
- Shows current IRMA price
- Generates Rust code for Solana program integration
- Provides account context and PDA addresses

### 3. `create_irma_usdt_pool_v2.ts` - Pool Setup Helper
A more technical script that shows the pool creation process and checks for existing pools.

**Usage:**
```bash
ts-node scripts/create_irma_usdt_pool_v2.ts
```

## Configuration

All scripts use these constants:

```typescript
const IRMA_MINT = new PublicKey("irmacFBRx7148dQ6qq1zpzUPq57Jr8V4vi5eXDxsDe1");
const USDT_MINT = new PublicKey("Es9vMFrzaTmVRL3P15S3BtQDvVwWZEzPDk1e45sA2v6p");
const FUNDER = new PublicKey("irmaVaRc8xvqiXxAA55dYK2NbRidJ27DPzyQ4HEDfSV");
const TICK_SPACING = 1; // For 0.01% fee tier
```

## Pool Specifications

- **Token A:** IRMA (`irmacFBRx7148dQ6qq1zpzUPq57Jr8V4vi5eXDxsDe1`)
- **Token B:** USDT (`Es9vMFrzaTmVRL3P15S3BtQDvVwWZEzPDk1e45sA2v6p`)
- **Tick Spacing:** 1 (for 0.01% fee tier)
- **Initial Price:** 1 IRMA = 1 USDT
- **Network:** Devnet
- **Funder:** `irmaVaRc8xvqiXxAA55dYK2NbRidJ27DPzyQ4HEDfSV`

## Prerequisites

1. **Node.js and TypeScript** installed
2. **Dependencies** installed: `npm install`
3. **IRMA token** deployed to devnet
4. **USDT token** available on devnet (or use a devnet equivalent)
5. **Funded wallet** for the funder address

## Step-by-Step Pool Creation

### Option 1: Web UI (Recommended)
1. Run the guide: `ts-node scripts/pool_creation_guide.ts`
2. Follow the web UI instructions
3. Use Orca's interface at https://www.orca.so/pools

### Option 2: CLI Tools
```bash
# Install Orca CLI
npm install -g @orca-so/whirlpools-cli

# Create pool
whirlpools create-pool \
  --network devnet \
  --token-a irmacFBRx7148dQ6qq1zpzUPq57Jr8V4vi5eXDxsDe1 \
  --token-b Es9vMFrzaTmVRL3P15S3BtQDvVwWZEzPDk1e45sA2v6p \
  --tick-spacing 1 \
  --initial-price 1.0 \
  --funder irmaVaRc8xvqiXxAA55dYK2NbRidJ27DPzyQ4HEDfSV
```

### Option 3: TypeScript SDK
Use the code examples generated by the `pool_creation_guide.ts` script.

## Integration with IRMA Solana Program

After the pool is created:

1. **Run the integration demo:**
   ```bash
   ts-node scripts/pool_integration_demo.ts
   ```

2. **Copy the generated Rust code** into your IRMA program

3. **Use the provided account context** for swap operations

4. **Implement price reading** using the oracle PDA

## Example Integration Code

```rust
// Account context for IRMA program
#[derive(Accounts)]
pub struct SwapWithOrca<'info> {
    #[account(address = orca_whirlpools::ID)]
    pub whirlpools_program: AccountInfo<'info>,
    
    #[account(mut)]
    pub whirlpool: AccountInfo<'info>,
    
    pub oracle: AccountInfo<'info>,
    
    // ... other accounts
}

// Function to get IRMA price
pub fn get_irma_price_from_orca(ctx: Context<ReadOrcaPrice>) -> Result<u64> {
    // Implementation provided by integration demo
}
```

## Troubleshooting

### Pool Not Found
- Ensure both IRMA and USDT tokens exist on devnet
- Check that the pool has been created successfully
- Verify the correct token mint addresses

### Transaction Failed
- Ensure the funder wallet has sufficient SOL
- Check that both tokens are properly configured
- Verify network connectivity to devnet

### Price Reading Issues
- Pool may need initial liquidity before price can be read
- Check that TickArrays are properly initialized
- Verify oracle PDA is correct

## Resources

- [Orca Documentation](https://docs.orca.so/)
- [Whirlpools SDK](https://github.com/orca-so/whirlpools)
- [Orca Discord](https://discord.gg/orcaprotocol)

## Notes

- These scripts are configured for **devnet** testing
- For mainnet deployment, update RPC URLs and addresses
- Always test with small amounts first
- Consider slippage and price impact for larger trades